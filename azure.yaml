# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: gen-ai-bot-in-a-box
hooks:
  preup:
    windows:
      shell: pwsh
      run: azd env set PRINCIPAL_ID $(az ad signed-in-user show --query id -o tsv)
    posix:
      shell: sh
      run: azd env set PRINCIPAL_ID $(az ad signed-in-user show --query id -o tsv)
  # Bot Framework Python doesn't support MSI - switch to single tenant app
  predeploy: 
    windows:
      shell: pwsh
      run: pwsh ./scripts/configureSingleTenantApp.ps1
    posix:
      shell: sh
      run: sh ./scripts/configureSingleTenantApp.sh
services:
    # genai-bot-app:
    #     project: src/python
    #     host: appservice
    #     language: python
    genai-bot-app:
        project: src/dotnet
        host: appservice
        language: dotnet
    # genai-bot-app:
    #     project: src/node
    #     host: appservice
    #     language: js
    